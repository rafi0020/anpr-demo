{"version":3,"file":"DemoPage-CRPHQZ-q.js","sources":["../../src/components/VideoPlayer.tsx","../../src/components/StoryTimeline.tsx","../../src/components/DetectionOverlay.tsx","../../src/components/PipelinePanel.tsx","../../src/pages/DemoPage.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\n\r\ninterface VideoPlayerProps {\r\n  videoUrl: string;\r\n  onTimeUpdate: (time: number) => void;\r\n  isPlaying: boolean;\r\n  onPlayPause: () => void;\r\n  children?: React.ReactNode; // Allow overlay as children\r\n}\r\n\r\nconst VideoPlayer: React.FC<VideoPlayerProps> = ({\r\n  videoUrl,\r\n  onTimeUpdate,\r\n  isPlaying,\r\n  onPlayPause,\r\n  children,\r\n}) => {\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (videoRef.current) {\r\n      if (isPlaying) {\r\n        videoRef.current.play().catch((err) => {\r\n          console.error('Play error:', err);\r\n          setError('Failed to play video');\r\n        });\r\n      } else {\r\n        videoRef.current.pause();\r\n      }\r\n    }\r\n  }, [isPlaying]);\r\n\r\n  const handleTimeUpdate = () => {\r\n    if (videoRef.current) {\r\n      onTimeUpdate(videoRef.current.currentTime);\r\n    }\r\n  };\r\n\r\n  const handleLoadedData = () => {\r\n    setIsLoaded(true);\r\n    setError(null);\r\n    console.log('Video loaded successfully');\r\n  };\r\n\r\n  const handleError = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\r\n    const video = e.currentTarget;\r\n    const errorCode = video.error?.code;\r\n    const errorMessage = video.error?.message || 'Unknown error';\r\n    console.error('Video error:', errorCode, errorMessage);\r\n    setError(`Video error: ${errorMessage}`);\r\n    setIsLoaded(false);\r\n  };\r\n\r\n  const handleClick = () => {\r\n    onPlayPause();\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative w-full h-full bg-black\">\r\n      <video\r\n        ref={videoRef}\r\n        src={videoUrl}\r\n        className=\"w-full h-full object-contain\"\r\n        onTimeUpdate={handleTimeUpdate}\r\n        onLoadedData={handleLoadedData}\r\n        onError={handleError}\r\n        onCanPlay={() => console.log('Video can play')}\r\n        onClick={handleClick}\r\n        controls={false}\r\n        playsInline\r\n        muted={false}\r\n      />\r\n      {/* Render overlay children (DetectionOverlay) */}\r\n      {children}\r\n      {error && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-80\">\r\n          <div className=\"text-center p-4\">\r\n            <p className=\"text-red-500 mb-2\">{error}</p>\r\n            <p className=\"text-gray-400 text-sm\">URL: {videoUrl}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {!isLoaded && !error && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50\">\r\n          <div className=\"text-white\">Loading video...</div>\r\n        </div>\r\n      )}\r\n      {isLoaded && !isPlaying && !error && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n          <div className=\"w-16 h-16 bg-white bg-opacity-80 rounded-full flex items-center justify-center\">\r\n            <svg className=\"w-8 h-8 text-gray-800 ml-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z\" />\r\n            </svg>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoPlayer;\r\n","import React from 'react';\r\nimport { StoryData } from '@/types';\r\n\r\ninterface StoryTimelineProps {\r\n  storyData: StoryData;\r\n  currentTime: number; // in milliseconds\r\n  onSeek: (timeMs: number) => void;\r\n}\r\n\r\nconst StoryTimeline: React.FC<StoryTimelineProps> = ({\r\n  storyData,\r\n  currentTime,\r\n  onSeek,\r\n}) => {\r\n  const totalDuration = storyData.metadata.duration;\r\n  const currentSegment = storyData.segments.find(\r\n    segment => currentTime >= segment.startMs && currentTime <= segment.endMs\r\n  );\r\n\r\n  const handleTimelineClick = (event: React.MouseEvent<HTMLDivElement>) => {\r\n    const rect = event.currentTarget.getBoundingClientRect();\r\n    const clickX = event.clientX - rect.left;\r\n    const percentage = clickX / rect.width;\r\n    const timeMs = percentage * totalDuration;\r\n    onSeek(timeMs);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-4\">\r\n      <h3 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">\r\n        Story Timeline\r\n      </h3>\r\n\r\n      {/* Current Segment Info */}\r\n      {currentSegment && (\r\n        <div className=\"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <h4 className=\"font-medium text-blue-900 dark:text-blue-100\">\r\n              {currentSegment.title}\r\n            </h4>\r\n            <span className=\"text-sm text-blue-700 dark:text-blue-300\">\r\n              {Math.floor(currentSegment.startMs / 1000)}s - {Math.floor(currentSegment.endMs / 1000)}s\r\n            </span>\r\n          </div>\r\n          <p className=\"text-sm text-blue-800 dark:text-blue-200\">\r\n            {currentSegment.narration}\r\n          </p>\r\n          {currentSegment.expectedActions && (\r\n            <div className=\"mt-2\">\r\n              <span className=\"text-xs font-medium text-blue-700 dark:text-blue-300\">\r\n                System Actions:\r\n              </span>\r\n              <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                {currentSegment.expectedActions.map((action, index) => (\r\n                  <span\r\n                    key={index}\r\n                    className=\"px-2 py-1 bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-200 text-xs rounded\"\r\n                  >\r\n                    {action}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Timeline Visualization */}\r\n      <div className=\"relative overflow-hidden\">\r\n        <div\r\n          className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded-full cursor-pointer relative overflow-hidden\"\r\n          onClick={handleTimelineClick}\r\n        >\r\n          {/* Progress bar */}\r\n          <div\r\n            className=\"h-full bg-blue-500 rounded-full transition-all duration-100\"\r\n            style={{ width: `${Math.min((currentTime / totalDuration) * 100, 100)}%` }}\r\n          />\r\n\r\n          {/* Segment markers */}\r\n          {storyData.segments.map((segment, index) => {\r\n            const position = (segment.startMs / totalDuration) * 100;\r\n            const isCurrent = currentSegment?.startMs === segment.startMs;\r\n\r\n            return (\r\n              <div\r\n                key={index}\r\n                className={`absolute top-0 w-1 h-4 transform -translate-x-1/2 -translate-y-1/2 rounded ${\r\n                  isCurrent ? 'bg-red-500' : 'bg-gray-400'\r\n                } left-[${position}%]`}\r\n                title={`${segment.title} (${Math.floor(segment.startMs / 1000)}s)`}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Time labels */}\r\n        <div className=\"flex justify-between mt-2 text-xs text-gray-600 dark:text-gray-400\">\r\n          <span>0s</span>\r\n          <span>{Math.floor(totalDuration / 1000)}s</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Segment List */}\r\n      <div className=\"mt-4 space-y-2\">\r\n        {storyData.segments.map((segment, index) => {\r\n          const isCurrent = currentSegment?.startMs === segment.startMs;\r\n          const isPast = currentTime > segment.endMs;\r\n\r\n          return (\r\n            <div\r\n              key={index}\r\n              className={`p-2 rounded cursor-pointer transition-colors ${\r\n                isCurrent\r\n                  ? 'bg-blue-100 dark:bg-blue-900/30 border-l-4 border-blue-500'\r\n                  : isPast\r\n                  ? 'bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500'\r\n                  : 'bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600'\r\n              }`}\r\n              onClick={() => onSeek(segment.startMs)}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <span className={`w-3 h-3 rounded-full ${\r\n                    isCurrent ? 'bg-blue-500' :\r\n                    isPast ? 'bg-green-500' :\r\n                    'bg-gray-400'\r\n                  }`} />\r\n                  <span className=\"font-medium text-sm\">\r\n                    {segment.title}\r\n                  </span>\r\n                </div>\r\n                <span className=\"text-xs text-gray-500\">\r\n                  {Math.floor(segment.startMs / 1000)}s\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\r\n                {segment.narration.substring(0, 60)}...\r\n              </p>\r\n              {(isCurrent || isPast) && segment.expectedActions && (\r\n                <div className=\"mt-2\">\r\n                  <div className=\"flex flex-wrap gap-1\">\r\n                    {segment.expectedActions.map((action, actionIndex) => (\r\n                      <span\r\n                        key={actionIndex}\r\n                        className={`px-2 py-1 text-xs rounded ${\r\n                          isCurrent\r\n                            ? 'bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-200'\r\n                            : 'bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200'\r\n                        }`}\r\n                      >\r\n                        {action}\r\n                      </span>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Expected Plate */}\r\n      {/* <div className=\"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg\">\r\n        <h4 className=\"font-medium text-yellow-900 dark:text-yellow-100 mb-1\">\r\n          Expected Plate Text\r\n        </h4>\r\n        <p className=\"text-lg font-mono text-yellow-800 dark:text-yellow-200 bengali-text\">\r\n          {storyData.expectedPlate}\r\n        </p>\r\n      </div> */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StoryTimeline;\r\n","import React, { useRef, useEffect, useState } from 'react';\r\nimport { Detection, Track, ROIPolygon } from '@/types';\r\n\r\ninterface DetectionOverlayProps {\r\n  detections: Detection[];\r\n  tracks: Track[];\r\n  roi: ROIPolygon | null;\r\n  onROIUpdate: (roi: ROIPolygon) => void;\r\n  videoWidth?: number;  // Original video width (e.g., 1920)\r\n  videoHeight?: number; // Original video height (e.g., 1080)\r\n}\r\n\r\nconst DetectionOverlay: React.FC<DetectionOverlayProps> = ({\r\n  detections,\r\n  tracks,\r\n  roi,\r\n  onROIUpdate: _onROIUpdate,\r\n  videoWidth = 1920,\r\n  videoHeight = 1080,\r\n}) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const [canvasSize, setCanvasSize] = useState({ width: 0, height: 0 });\r\n\r\n  // Handle canvas resize\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const handleResize = () => {\r\n      const rect = canvas.getBoundingClientRect();\r\n      console.log('DetectionOverlay: Resizing canvas to', rect.width, 'x', rect.height);\r\n      if (canvas.width !== rect.width || canvas.height !== rect.height) {\r\n        canvas.width = rect.width;\r\n        canvas.height = rect.height;\r\n        setCanvasSize({ width: rect.width, height: rect.height });\r\n      }\r\n    };\r\n\r\n    handleResize();\r\n    window.addEventListener('resize', handleResize);\r\n    \r\n    // Use ResizeObserver for more accurate resize detection\r\n    const resizeObserver = new ResizeObserver(handleResize);\r\n    resizeObserver.observe(canvas);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n      resizeObserver.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // Draw detections, tracks, and ROI\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    // Debug: Log detections\r\n    if (detections.length > 0) {\r\n      console.log('DetectionOverlay: Drawing', detections.length, 'detections', detections);\r\n    }\r\n\r\n    // Calculate video aspect ratio and canvas aspect ratio\r\n    const videoAspect = videoWidth / videoHeight;\r\n    const canvasAspect = canvas.width / canvas.height;\r\n\r\n    let renderWidth = canvas.width;\r\n    let renderHeight = canvas.height;\r\n    let offsetX = 0;\r\n    let offsetY = 0;\r\n\r\n    // Video uses object-contain, so calculate actual render size\r\n    if (canvasAspect > videoAspect) {\r\n      // Canvas is wider than video - video has vertical bars on sides\r\n      renderWidth = canvas.height * videoAspect;\r\n      offsetX = (canvas.width - renderWidth) / 2;\r\n    } else {\r\n      // Canvas is taller than video - video has horizontal bars on top/bottom\r\n      renderHeight = canvas.width / videoAspect;\r\n      offsetY = (canvas.height - renderHeight) / 2;\r\n    }\r\n\r\n    // Calculate scale factors based on actual render size\r\n    const scaleX = renderWidth / videoWidth;\r\n    const scaleY = renderHeight / videoHeight;\r\n\r\n    // Fine-tune adjustment (move slightly left and down)\r\n    const adjustX = -25; // Negative = left\r\n    const adjustY = 30;  // Positive = down\r\n\r\n    console.log('DetectionOverlay: Canvas', canvas.width, 'x', canvas.height, \r\n                'Render:', renderWidth, 'x', renderHeight, \r\n                'Offset:', offsetX, offsetY, \r\n                'Scale:', scaleX, scaleY);\r\n\r\n    // Clear canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // Draw ROI if present\r\n    if (roi && roi.active) {\r\n      ctx.strokeStyle = 'rgba(59, 130, 246, 0.8)';\r\n      ctx.lineWidth = 2;\r\n      ctx.setLineDash([5, 5]);\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(roi.points[0].x * scaleX + offsetX + adjustX, roi.points[0].y * scaleY + offsetY + adjustY);\r\n\r\n      for (let i = 1; i < roi.points.length; i++) {\r\n        ctx.lineTo(roi.points[i].x * scaleX + offsetX + adjustX, roi.points[i].y * scaleY + offsetY + adjustY);\r\n      }\r\n\r\n      ctx.closePath();\r\n      ctx.fillStyle = 'rgba(59, 130, 246, 0.1)';\r\n      ctx.fill();\r\n      ctx.stroke();\r\n\r\n      // Draw corner points\r\n      ctx.fillStyle = 'rgba(59, 130, 246, 1)';\r\n      roi.points.forEach(point => {\r\n        ctx.beginPath();\r\n        ctx.arc(point.x * scaleX + offsetX + adjustX, point.y * scaleY + offsetY + adjustY, 3, 0, Math.PI * 2);\r\n        ctx.fill();\r\n      });\r\n    }\r\n\r\n    // Draw detections\r\n    detections.forEach(detection => {\r\n      const [x1, y1, x2, y2] = detection.bbox;\r\n      \r\n      // Scale coordinates to canvas size and add offset with adjustment\r\n      const scaledX1 = x1 * scaleX + offsetX + adjustX;\r\n      const scaledY1 = y1 * scaleY + offsetY + adjustY;\r\n      const scaledX2 = x2 * scaleX + offsetX + adjustX;\r\n      const scaledY2 = y2 * scaleY + offsetY + adjustY;\r\n      const scaledWidth = scaledX2 - scaledX1;\r\n      const scaledHeight = scaledY2 - scaledY1;\r\n\r\n      // Different colors for different types\r\n      if (detection.type === 'plate') {\r\n        ctx.strokeStyle = '#10B981'; // Green for plates\r\n        ctx.fillStyle = 'rgba(16, 185, 129, 0.2)';\r\n        ctx.lineWidth = 3; // Thicker line for plates\r\n      } else {\r\n        ctx.strokeStyle = '#3B82F6'; // Blue for vehicles\r\n        ctx.fillStyle = 'rgba(59, 130, 246, 0.1)';\r\n        ctx.lineWidth = 2;\r\n      }\r\n\r\n      ctx.setLineDash([]);\r\n\r\n      // Draw bounding box\r\n      ctx.fillRect(scaledX1, scaledY1, scaledWidth, scaledHeight);\r\n      ctx.strokeRect(scaledX1, scaledY1, scaledWidth, scaledHeight);\r\n\r\n      // Draw label background\r\n      const label = `${detection.type}: ${(detection.conf * 100).toFixed(1)}%`;\r\n      ctx.font = '12px monospace';\r\n      const textWidth = ctx.measureText(label).width;\r\n      \r\n      if (detection.type === 'plate') {\r\n        ctx.fillStyle = '#10B981'; // Green background for plate labels\r\n      } else {\r\n        ctx.fillStyle = '#3B82F6'; // Blue background for vehicle labels\r\n      }\r\n      ctx.fillRect(scaledX1, scaledY1 - 18, textWidth + 6, 16);\r\n\r\n      // Draw confidence text\r\n      ctx.fillStyle = '#FFFFFF';\r\n      ctx.fillText(label, scaledX1 + 3, scaledY1 - 5);\r\n    });\r\n\r\n    // Draw track IDs\r\n    tracks.forEach(track => {\r\n      if (track.status === 'active') {\r\n        const [x1, y1, x2] = track.bbox;\r\n        const scaledX1 = x1 * scaleX + offsetX + adjustX;\r\n        const scaledY1 = y1 * scaleY + offsetY + adjustY;\r\n        const scaledX2 = x2 * scaleX + offsetX + adjustX;\r\n        const centerX = (scaledX1 + scaledX2) / 2;\r\n        const centerY = scaledY1 - 15;\r\n\r\n        // Draw track ID label\r\n        ctx.fillStyle = '#EF4444'; // Red background\r\n        ctx.fillRect(centerX - 15, centerY - 8, 30, 16);\r\n\r\n        ctx.fillStyle = '#FFFFFF';\r\n        ctx.font = 'bold 12px monospace';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText(track.id.toString(), centerX, centerY + 4);\r\n        ctx.textAlign = 'left';\r\n      }\r\n    });\r\n\r\n  }, [detections, tracks, roi, videoWidth, videoHeight, canvasSize]);\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      className=\"absolute inset-0 pointer-events-none w-full h-full z-10\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default DetectionOverlay;\r\n","import React from 'react';\r\nimport { PipelineState, TraceLog, OCRCandidate } from '@/types';\r\n\r\ninterface PipelinePanelProps {\r\n  pipelineState: Partial<PipelineState>;\r\n  logs: TraceLog[];\r\n  processingStage?: string;\r\n  ocrCandidates?: OCRCandidate[];\r\n  detectedPlate?: string | null;\r\n  plateConfidence?: number;\r\n}\r\n\r\nconst PipelinePanel: React.FC<PipelinePanelProps> = ({ \r\n  pipelineState, \r\n  logs,\r\n  processingStage = 'idle',\r\n  ocrCandidates = [],\r\n  detectedPlate = null,\r\n  plateConfidence = 0\r\n}) => {\r\n  const getLogLevelColor = (level: string) => {\r\n    switch (level) {\r\n      case 'error': return 'text-red-600 bg-red-50 dark:bg-red-900/20';\r\n      case 'warn': return 'text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20';\r\n      case 'info': return 'text-blue-600 bg-blue-50 dark:bg-blue-900/20';\r\n      case 'debug': return 'text-gray-500 bg-gray-50 dark:bg-gray-700/50';\r\n      default: return 'text-gray-600';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow h-full\">\r\n      <div className=\"border-b border-gray-200 dark:border-gray-700 p-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n          üîç Pipeline Inspector\r\n        </h3>\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\r\n          Real-time pipeline transparency\r\n        </p>\r\n      </div>\r\n\r\n      {/* Pipeline Status */}\r\n      <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n          Pipeline Status\r\n        </h4>\r\n        <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded p-2\">\r\n            <span className=\"text-gray-500 dark:text-gray-400\">Video ID</span>\r\n            <p className=\"font-mono text-gray-900 dark:text-white\">\r\n              {pipelineState.videoId || 'N/A'}\r\n            </p>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded p-2\">\r\n            <span className=\"text-gray-500 dark:text-gray-400\">Time</span>\r\n            <p className=\"font-mono text-gray-900 dark:text-white\">\r\n              {((pipelineState.currentTime || 0) / 1000).toFixed(2)}s\r\n            </p>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded p-2\">\r\n            <span className=\"text-gray-500 dark:text-gray-400\">Detections</span>\r\n            <p className=\"font-mono text-gray-900 dark:text-white\">\r\n              {pipelineState.detections?.length || 0}\r\n            </p>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded p-2\">\r\n            <span className=\"text-gray-500 dark:text-gray-400\">Tracks</span>\r\n            <p className=\"font-mono text-gray-900 dark:text-white\">\r\n              {pipelineState.tracks?.length || 0}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Active Tracks */}\r\n      {pipelineState.tracks && pipelineState.tracks.length > 0 && (\r\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            Active Tracks\r\n          </h4>\r\n          <div className=\"space-y-2 max-h-32 overflow-y-auto\">\r\n            {pipelineState.tracks.map((track) => (\r\n              <div\r\n                key={track.id}\r\n                className=\"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded text-sm\"\r\n              >\r\n                <span className=\"font-mono text-primary-600\">\r\n                  Track #{track.id}\r\n                </span>\r\n                <span className={`px-2 py-0.5 rounded text-xs ${\r\n                  track.status === 'active' \r\n                    ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                    : 'bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300'\r\n                }`}>\r\n                  {track.status}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Processing Stage */}\r\n      <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n          Processing Stage\r\n        </h4>\r\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded p-2 text-sm\">\r\n          <span className=\"text-yellow-700 dark:text-yellow-400 font-medium\">\r\n            {processingStage}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* OCR Candidates */}\r\n      {ocrCandidates.length > 0 && (\r\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            üî§ OCR Candidates\r\n          </h4>\r\n          <div className=\"space-y-1\">\r\n            {ocrCandidates.map((candidate, index) => (\r\n              <div\r\n                key={index}\r\n                className={`flex items-center justify-between p-2 rounded text-sm ${\r\n                  index === 0 \r\n                    ? 'bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800'\r\n                    : 'bg-gray-50 dark:bg-gray-700'\r\n                }`}\r\n              >\r\n                <span className=\"font-mono text-lg\">\r\n                  {candidate.text}\r\n                </span>\r\n                <span className={`px-2 py-0.5 rounded text-xs font-medium ${\r\n                  candidate.conf >= 0.9 \r\n                    ? 'bg-green-100 text-green-800'\r\n                    : candidate.conf >= 0.7\r\n                    ? 'bg-yellow-100 text-yellow-800'\r\n                    : 'bg-red-100 text-red-800'\r\n                }`}>\r\n                  {(candidate.conf * 100).toFixed(0)}%\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Detected Plate Result */}\r\n      {detectedPlate && (\r\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-700 bg-green-50 dark:bg-green-900/20\">\r\n          <h4 className=\"text-sm font-medium text-green-700 dark:text-green-400 mb-2\">\r\n            ‚úÖ Detected Plate\r\n          </h4>\r\n          <div className=\"text-center\">\r\n            <p className=\"text-2xl font-bold text-green-800 dark:text-green-300 font-mono\">\r\n              {detectedPlate}\r\n            </p>\r\n            <p className=\"text-sm text-green-600 dark:text-green-500 mt-1\">\r\n              Confidence: {(plateConfidence * 100).toFixed(1)}%\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ROI Status */}\r\n      {pipelineState.roi && (\r\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            Region of Interest\r\n          </h4>\r\n          <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded p-2 text-sm\">\r\n            <span className=\"text-blue-600 dark:text-blue-400\">\r\n              {pipelineState.roi.points.length} points defined\r\n            </span>\r\n            {pipelineState.roi.active && (\r\n              <span className=\"ml-2 text-green-600 dark:text-green-400\">‚óè Active</span>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Trace Logs */}\r\n      <div className=\"p-4\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center justify-between\">\r\n          <span>Trace Logs</span>\r\n          <span className=\"text-xs text-gray-500\">\r\n            {logs.length} entries\r\n          </span>\r\n        </h4>\r\n        <div className=\"space-y-1 max-h-64 overflow-y-auto font-mono text-xs\">\r\n          {logs.length === 0 ? (\r\n            <p className=\"text-gray-500 dark:text-gray-400 text-center py-4\">\r\n              No logs yet. Play video to see pipeline activity.\r\n            </p>\r\n          ) : (\r\n            logs.slice(-20).reverse().map((log, index) => (\r\n              <div\r\n                key={index}\r\n                className={`p-2 rounded ${getLogLevelColor(log.level)}`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"font-semibold\">{log.stage}</span>\r\n                  <span className=\"text-gray-400\">\r\n                    {new Date(log.timestamp).toLocaleTimeString()}\r\n                  </span>\r\n                </div>\r\n                <p className=\"mt-1 opacity-80\">{log.action}</p>\r\n                {log.data && Object.keys(log.data).length > 0 && (\r\n                  <pre className=\"mt-1 text-xs opacity-60 overflow-hidden text-ellipsis\">\r\n                    {JSON.stringify(log.data, null, 0).substring(0, 100)}\r\n                  </pre>\r\n                )}\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PipelinePanel;\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport VideoPlayer from '../components/VideoPlayer';\r\nimport StoryTimeline from '../components/StoryTimeline';\r\nimport DetectionOverlay from '../components/DetectionOverlay';\r\nimport PipelinePanel from '../components/PipelinePanel';\r\nimport { StoryData, PipelineState, OCRCandidate, ANPREvent } from '@/types';\r\nimport { TraceLogger } from '@/pipeline/TraceLogger';\r\nimport { DetectorPrecomputed } from '@/pipeline/DetectorPrecomputed';\r\nimport { TrackerSimple } from '@/pipeline/TrackerSimple';\r\nimport { OCRPrecomputed } from '@/pipeline/OCRPrecomputed';\r\nimport { Voter } from '@/pipeline/Voter';\r\nimport { ROI } from '@/pipeline/ROI';\r\nimport { useANPRStore } from '@/store';\r\n\r\nconst DemoPage: React.FC = () => {\r\n  const addEvent = useANPRStore((state) => state.addEvent);\r\n  const setSession = useANPRStore((state) => state.setSession);\r\n  const setCandidates = useANPRStore((state) => state.setCandidates);\r\n  const setPipelineStateStore = useANPRStore((state) => state.setPipelineState);\r\n  const addTraceLog = useANPRStore((state) => state.addTraceLog);\r\n  \r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [storyData, setStoryData] = useState<StoryData | null>(null);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [ocrCandidates, setOcrCandidates] = useState<OCRCandidate[]>([]);\r\n  const [detectedPlate, setDetectedPlate] = useState<string | null>(null);\r\n  const [plateConfidence, setPlateConfidence] = useState<number>(0);\r\n  const [processingStage, setProcessingStage] = useState<string>('idle');\r\n  const [hasCreatedEvent, setHasCreatedEvent] = useState(false);\r\n  const [pipelineState, setPipelineState] = useState<Partial<PipelineState>>({\r\n    videoId: 'gateA_entry',\r\n    currentTime: 0,\r\n    isPlaying: false,\r\n    detections: [],\r\n    tracks: [],\r\n    activeSessions: [],\r\n    events: [],\r\n    roi: null,\r\n    logs: []\r\n  });\r\n\r\n  // Pipeline modules\r\n  const loggerRef = useRef(new TraceLogger());\r\n  const detectorRef = useRef(new DetectorPrecomputed(loggerRef.current));\r\n  const trackerRef = useRef(new TrackerSimple(loggerRef.current));\r\n  const ocrRef = useRef(new OCRPrecomputed(loggerRef.current));\r\n  const voterRef = useRef(new Voter(loggerRef.current));\r\n  const roiRef = useRef(new ROI(loggerRef.current));\r\n  \r\n  // Wrap logger to send logs to store\r\n  useEffect(() => {\r\n    const originalInfo = loggerRef.current.info.bind(loggerRef.current);\r\n    const originalWarn = loggerRef.current.warn.bind(loggerRef.current);\r\n    const originalError = loggerRef.current.error.bind(loggerRef.current);\r\n    \r\n    loggerRef.current.info = (module, message, data?) => {\r\n      originalInfo(module, message, data);\r\n      addTraceLog({ level: 'info', module, message, data, timestamp: Date.now() });\r\n    };\r\n    \r\n    loggerRef.current.warn = (module, message, data?) => {\r\n      originalWarn(module, message, data);\r\n      addTraceLog({ level: 'warn', module, message, data, timestamp: Date.now() });\r\n    };\r\n    \r\n    loggerRef.current.error = (module, message, data?) => {\r\n      originalError(module, message, data);\r\n      addTraceLog({ level: 'error', module, message, data, timestamp: Date.now() });\r\n    };\r\n  }, [addTraceLog]);\r\n\r\n  // Load initial data\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        const baseUrl = import.meta.env.BASE_URL;\r\n        \r\n        // Load story data\r\n        const storyResponse = await fetch(`${baseUrl}assets/story/gateA_entry.story.json`);\r\n        const story = await storyResponse.json();\r\n        setStoryData(story);\r\n\r\n        // Load detection data\r\n        await detectorRef.current.loadDetections(`${baseUrl}assets/detections/gateA_entry.dets.json`);\r\n\r\n        // Load OCR data\r\n        await ocrRef.current.loadOCRData('gateA_entry', baseUrl);\r\n\r\n        setIsLoading(false);\r\n        loggerRef.current.info('DemoPage', 'Initial data loaded');\r\n      } catch (error) {\r\n        console.error('Failed to load data:', error);\r\n        loggerRef.current.error('DemoPage', 'Failed to load initial data', { error });\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // Process frame\r\n  const processFrame = useCallback((timeMs: number) => {\r\n    // Get detections for current time\r\n    const detections = detectorRef.current.getDetections(timeMs);\r\n    \r\n    console.log('DemoPage processFrame:', timeMs, 'detections:', detections.length);\r\n    \r\n    // Update tracker\r\n    const tracks = trackerRef.current.update(detections, timeMs);\r\n\r\n    // Check for plate detections and run OCR\r\n    const plateDetections = detections.filter(d => d.type === 'plate');\r\n    let currentStage = 'idle';\r\n    \r\n    if (detections.length > 0 && plateDetections.length === 0) {\r\n      currentStage = 'detecting';\r\n      setProcessingStage('Detecting vehicle...');\r\n      loggerRef.current.info('Pipeline', 'Vehicle detected, searching for plate');\r\n    }\r\n    \r\n    if (plateDetections.length > 0) {\r\n      currentStage = 'ocr';\r\n      setProcessingStage('Reading plate...');\r\n      \r\n      // Get OCR candidates for active tracks\r\n      const activeTrack = tracks.find(t => t.status === 'active');\r\n      if (activeTrack) {\r\n        // Update store session\r\n        setSession({\r\n          trackId: typeof activeTrack.id === 'number' ? activeTrack.id : parseInt(String(activeTrack.id)),\r\n          crops: [],\r\n          startTimeMs: timeMs,\r\n          endTimeMs: timeMs\r\n        });\r\n        \r\n        const candidates = ocrRef.current.getCandidatesForTrack(String(activeTrack.id));\r\n        \r\n        if (candidates.length > 0) {\r\n          // Flatten and set current candidates\r\n          const flatCandidates = candidates.flat();\r\n          setOcrCandidates(flatCandidates.slice(0, 5));\r\n          setCandidates(flatCandidates.slice(0, 5));\r\n          \r\n          // Run voting on candidates\r\n          const voteResult = voterRef.current.vote(candidates);\r\n          \r\n          if (voteResult.winner) {\r\n            setDetectedPlate(voteResult.winner);\r\n            setPlateConfidence(voteResult.confidence);\r\n            setProcessingStage('Plate recognized!');\r\n            currentStage = 'recognized';\r\n            \r\n            loggerRef.current.info('Pipeline', 'Plate recognized', {\r\n              plate: voteResult.winner,\r\n              confidence: (voteResult.confidence * 100).toFixed(1) + '%',\r\n              method: voteResult.method\r\n            });\r\n            \r\n            // Create event only once per detection\r\n            if (!hasCreatedEvent && voteResult.confidence > 0.7) {\r\n              const event: ANPREvent = {\r\n                id: `evt_${Date.now()}_${activeTrack.id}`,\r\n                timestamp: new Date().toISOString(),\r\n                timeMs: timeMs,\r\n                trackId: activeTrack.id,\r\n                plate: voteResult.winner,\r\n                confidence: voteResult.confidence,\r\n                gate: 'Demo Gate',\r\n                status: 'ENTRY',\r\n                evidence: {\r\n                  frameTimeMs: timeMs,\r\n                  cropId: `crop_${activeTrack.id}`,\r\n                },\r\n                validation: {\r\n                  valid: true,\r\n                  mode: 'fallback',\r\n                  plate: voteResult.winner,\r\n                  reasons: [],\r\n                  warnings: []\r\n                },\r\n                voting: voteResult,\r\n                deduplication: {\r\n                  isDuplicate: false,\r\n                  reason: 'New detection'\r\n                }\r\n              };\r\n              \r\n              addEvent(event);\r\n              setHasCreatedEvent(true);\r\n              \r\n              loggerRef.current.info('Pipeline', 'Event created', {\r\n                eventId: event.id,\r\n                plate: event.plate\r\n              });\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } else if (timeMs < 2000) {\r\n      // Reset if no plate detected yet\r\n      setOcrCandidates([]);\r\n      setCandidates([]);\r\n      setDetectedPlate(null);\r\n      setPlateConfidence(0);\r\n      setProcessingStage('Waiting for vehicle...');\r\n      setHasCreatedEvent(false);\r\n    }\r\n    \r\n    // Update pipeline state\r\n    setPipelineState(prev => ({\r\n      ...prev,\r\n      currentTime: timeMs,\r\n      detections,\r\n      tracks,\r\n      logs: loggerRef.current.getRecentLogs(20)\r\n    }));\r\n    \r\n    // Update store pipeline state\r\n    setPipelineStateStore({\r\n      currentTime: timeMs,\r\n      detections,\r\n      tracks\r\n    });\r\n\r\n    loggerRef.current.debug('DemoPage', 'Frame processed', { \r\n      timeMs, \r\n      detectionCount: detections.length,\r\n      trackCount: tracks.length,\r\n      stage: currentStage\r\n    });\r\n  }, [hasCreatedEvent, addEvent, setSession, setCandidates, setPipelineStateStore, addTraceLog]);\r\n\r\n  const handleTimeUpdate = (time: number) => {\r\n    setCurrentTime(time);\r\n    processFrame(Math.floor(time * 1000)); // Convert to milliseconds\r\n  };\r\n\r\n  const handlePlayPause = () => {\r\n    setIsPlaying(!isPlaying);\r\n    setPipelineState(prev => ({ ...prev, isPlaying: !isPlaying }));\r\n  };\r\n\r\n  const handleROIUpdate = (roi: any) => {\r\n    roiRef.current.setPolygon(roi);\r\n    setPipelineState(prev => ({ ...prev, roi }));\r\n    loggerRef.current.info('DemoPage', 'ROI updated');\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading ANPR Demo System...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-4\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n          ANPR Pipeline Demo\r\n        </h2>\r\n        <p className=\"mt-2 text-gray-600 dark:text-gray-400\">\r\n          Real-time vehicle detection, tracking, and plate recognition with pipeline transparency\r\n        </p>\r\n      </div>\r\n\r\n      {/* Main Content Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Video Section */}\r\n        <div className=\"lg:col-span-2 space-y-4\">\r\n          {/* Video Player with Overlay */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-4\">\r\n            <div className=\"relative aspect-video bg-black rounded-lg overflow-hidden\">\r\n              <VideoPlayer\r\n                videoUrl={`${import.meta.env.BASE_URL}assets/videos/gateA_entry.mp4`}\r\n                onTimeUpdate={handleTimeUpdate}\r\n                isPlaying={isPlaying}\r\n                onPlayPause={handlePlayPause}\r\n              >\r\n                <DetectionOverlay\r\n                  detections={pipelineState.detections || []}\r\n                  tracks={pipelineState.tracks || []}\r\n                  roi={pipelineState.roi || null}\r\n                  onROIUpdate={handleROIUpdate}\r\n                  videoWidth={1920}\r\n                  videoHeight={1080}\r\n                />\r\n              </VideoPlayer>\r\n            </div>\r\n            \r\n            {/* Video Controls */}\r\n            <div className=\"mt-4 flex items-center space-x-4\">\r\n              <button\r\n                onClick={handlePlayPause}\r\n                className=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n              >\r\n                {isPlaying ? 'Pause' : 'Play'}\r\n              </button>\r\n              <div className=\"flex-1\">\r\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                  Time: {currentTime.toFixed(2)}s / 7.50s\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Story Timeline */}\r\n          {storyData && (\r\n            <StoryTimeline\r\n              storyData={storyData}\r\n              currentTime={currentTime * 1000}\r\n              onSeek={(timeMs) => handleTimeUpdate(timeMs / 1000)}\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {/* Pipeline Panel */}\r\n        <div className=\"lg:col-span-1\">\r\n          <PipelinePanel\r\n            pipelineState={pipelineState}\r\n            logs={pipelineState.logs || []}\r\n            processingStage={processingStage}\r\n            ocrCandidates={ocrCandidates}\r\n            detectedPlate={detectedPlate}\r\n            plateConfidence={plateConfidence}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Bar */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-4\">\r\n        <div className=\"flex items-center justify-between text-sm\">\r\n          <div className=\"flex items-center space-x-6\">\r\n            <span className=\"flex items-center\">\r\n              <span className=\"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse\"></span>\r\n              Pipeline Active\r\n            </span>\r\n            <span className=\"text-gray-600 dark:text-gray-400\">\r\n              Tracks: {pipelineState.tracks?.length || 0}\r\n            </span>\r\n            <span className=\"text-gray-600 dark:text-gray-400\">\r\n              Detections: {pipelineState.detections?.length || 0}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-4\">\r\n            <button className=\"text-primary-600 hover:text-primary-700\">\r\n              Export Logs\r\n            </button>\r\n            <button className=\"text-primary-600 hover:text-primary-700\">\r\n              Reset Pipeline\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DemoPage;\r\n"],"names":["VideoPlayer","videoUrl","onTimeUpdate","isPlaying","onPlayPause","children","videoRef","useRef","isLoaded","setIsLoaded","useState","error","setError","useEffect","err","handleTimeUpdate","handleLoadedData","handleError","e","video","errorCode","_a","errorMessage","_b","handleClick","jsxs","jsx","StoryTimeline","storyData","currentTime","onSeek","totalDuration","currentSegment","segment","handleTimelineClick","event","rect","timeMs","action","index","position","isCurrent","isPast","actionIndex","DetectionOverlay","detections","tracks","roi","_onROIUpdate","videoWidth","videoHeight","canvasRef","canvasSize","setCanvasSize","canvas","handleResize","resizeObserver","ctx","videoAspect","canvasAspect","renderWidth","renderHeight","offsetX","offsetY","scaleX","scaleY","adjustX","adjustY","i","point","detection","x1","y1","x2","y2","scaledX1","scaledY1","scaledX2","scaledY2","scaledWidth","scaledHeight","label","textWidth","track","centerX","centerY","PipelinePanel","pipelineState","logs","processingStage","ocrCandidates","detectedPlate","plateConfidence","getLogLevelColor","level","candidate","log","DemoPage","addEvent","useANPRStore","state","setSession","setCandidates","setPipelineStateStore","addTraceLog","isLoading","setIsLoading","setStoryData","setCurrentTime","setIsPlaying","setOcrCandidates","setDetectedPlate","setPlateConfidence","setProcessingStage","hasCreatedEvent","setHasCreatedEvent","setPipelineState","loggerRef","TraceLogger","detectorRef","DetectorPrecomputed","trackerRef","TrackerSimple","ocrRef","OCRPrecomputed","voterRef","Voter","roiRef","ROI","originalInfo","originalWarn","originalError","module","message","data","baseUrl","story","processFrame","useCallback","plateDetections","d","currentStage","activeTrack","t","candidates","flatCandidates","voteResult","prev","time","handlePlayPause","handleROIUpdate"],"mappings":"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"}